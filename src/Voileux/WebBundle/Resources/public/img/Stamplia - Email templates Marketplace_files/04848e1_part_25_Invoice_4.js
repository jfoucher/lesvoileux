// Generated by CoffeeScript 1.4.0
(function() {

  App.Model.Invoice = App.Model.extend({
    namespace: "invoice",
    url: function() {
      if (this.get('id')) {
        return "" + App.urlRoot + "/users/" + App.user.id + "/invoices/" + (this.get('id'));
      } else {
        return "" + App.urlRoot + "/users/" + App.user.id + "/invoices";
      }
    }
  });

  App.Model.InvoiceCollection = App.Collection.extend({
    model: App.Model.Invoice,
    namespace: "invoices",
    fetched: null,
    paginator_core: {
      type: 'GET',
      dataType: 'json',
      url: function() {
        return "" + App.urlRoot + "/users/" + App.user.id + "/invoices";
      }
    },
    paginator_ui: {
      firstPage: 1,
      currentPage: 1,
      perPage: App.perPage,
      totalPages: 10
    },
    server_api: function() {
      var ret;
      ret = {
        'per_page': function() {
          return this.perPage;
        },
        'page': function() {
          return this.currentPage;
        },
        'orderby': 'id',
        'format': 'json'
      };
      return ret;
    },
    parse: function(resp) {
      this.totalPages = resp.count;
      if (!this.namespace) {
        throw Error("a namespace property must be defined");
      }
      return resp[this.namespace];
    },
    initialize: function() {
      return this.fetched = $.Deferred();
    },
    fetch: function() {
      var _this = this;
      this.fetched = $.Deferred();
      return App.Collection.prototype.fetch.apply(this).done(function() {
        return _this.fetched.resolve(_this);
      });
    },
    url: function() {
      return "" + App.urlRoot + "/users/" + App.user.id + "/invoices";
    }
  });

}).call(this);
